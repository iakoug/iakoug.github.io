---
title: JS常用的设计模式
tags:
  - 设计模式
  - 算法
date: 2019-02-24 22:52:00
categories: 算法
---
持续更新
JS常用的设计模式以及应用场景

<!-- more -->

# 何谓设计模式

抛开官方的定义在我看来简单来说就是一个简单的思想被统一为规范，按照这个规范可以写出更优雅可控亦或性能更佳的代码，像是框架的单位
没必要被高大上的名词所吓倒，日常coding中或许一个不了解各种设计模式的程序员可能自己其实已经用到了很多。软件设计模式有很多，常规的有23种，本文针对其中常用的几种进行简要介绍

# 从最简单的单例模式开始

### 定义：

顾名仅可以可以被实例化一次：在它的核心结构中只包含一个被称为单例的特殊类。通过单例模式可以保证系统中，应用该模式的一个类只有一个实例。即一个类只有一个对象实例
在java中单例的定义：一个类有且仅有一个实例，并且自行实例化向整个系统提供

### 优点:
- 单例模式会阻止其他对象实例化其自己的单例对象的副本，从而确保所有对象都访问唯一实例
- 因为类控制了实例化过程，所以类可以灵活更改实例化过程

### 应用场景：

项目中通过只暴露一个入口，以避免变量污染

#### 最基本的单体模式
直接导出一个方法属性集合的对象
```js
// commonjs 导出
module.exports = {
  getInstace() {
    return this 
  }
}
```
#### 闭包
```js
const Ins1 = (function() {
  let instance = null
  // 利用闭包特性保证实例私有化
  return function(opt) {
    if (instance === null) {
      instance = this
    }

    for(let k in opt) {
      instance[k] = opt[k]
    }

    return instance
  }
})()
```
测试：
```js
const i1 = new Ins1({ name: 'i1' })
const i2 = new Ins1({ name: 'i2' })
console.log(i1 === i2) // true
console.log(i1.name) // i2
```
补充：在node中一个文件就是一个独立模块，若在某个js文件中导出一个类： `class T {} export default new T` 之后在其他任何外部文件多次引入其实都是保证了 T 类只被实例化了一次而不会被多次初始化。这是因为node遵循了commonjs的规范，所有文件模块在被引用时都会先去模块系统的缓存中查看这个文件是否存在，如果存在就返回缓存否则才会重新创建一个模块，而这个缓存其实也就限制了模块内脚本的多次初始化



{"componentChunkName":"component---src-templates-post-js","path":"/block-editor-depth-first/","result":{"data":{"markdownRemark":{"html":"<p>在写块编辑器的时候需要处理一个将粘贴的文本根据缩进关系转换为带有级联父子（兄弟）关系的（多种类型）块。\n如何根据缩进识别解析块编辑器中的父子关系？还原深度优先遍历算法解析的数据结构。</p>\n<hr>\n<h2 id=\"从深度优先遍历开始\" style=\"position:relative;\"><a href=\"#%E4%BB%8E%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E9%81%8D%E5%8E%86%E5%BC%80%E5%A7%8B\" aria-label=\"从深度优先遍历开始 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>从深度优先遍历开始</h2>\n<p>给定简易树形数据结构如：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> tree <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  value<span class=\"token operator\">:</span> <span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span>\n  children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n    value<span class=\"token operator\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span>\n    children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n        value<span class=\"token operator\">:</span> <span class=\"token string\">'1-1'</span><span class=\"token punctuation\">,</span>\n        children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n          value<span class=\"token operator\">:</span> <span class=\"token string\">'1-1-1'</span><span class=\"token punctuation\">,</span>\n          children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    value<span class=\"token operator\">:</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span>\n    children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n      value<span class=\"token operator\">:</span> <span class=\"token string\">'2-1'</span><span class=\"token punctuation\">,</span>\n      children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    value<span class=\"token operator\">:</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">,</span>\n    children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n      value<span class=\"token operator\">:</span> <span class=\"token string\">'3-1'</span><span class=\"token punctuation\">,</span>\n      children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>如果以深度优先算法来递归遍历平铺这个树：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">flat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tree<span class=\"token punctuation\">,</span> res <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tree<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    tree<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token function\">flat</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> res\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>将树深度优先遍历平铺后得到一个扁平List：</p>\n<p><img src=\"https://i.loli.net/2020/09/29/kPuDhvKotw5XiSq.png\" alt=\"WX20200929-135709@2x.png\"></p>\n<h2 id=\"块编辑器的级联关系\" style=\"position:relative;\"><a href=\"#%E5%9D%97%E7%BC%96%E8%BE%91%E5%99%A8%E7%9A%84%E7%BA%A7%E8%81%94%E5%85%B3%E7%B3%BB\" aria-label=\"块编辑器的级联关系 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>块编辑器的级联关系</h2>\n<blockquote>\n<p>块编辑器的块（任意类型）与块之间都可能存在的父子级联关系，在块操作的时候仍旧保持原有级联关系</p>\n</blockquote>\n<p>如果粘贴一段文本在块编辑器中，会根据这段文本的不同行的缩进关系来生成对应的块的父子（兄弟）关系，如何做到这一点？</p>\n<p>这其实就是将扁平的数据结构通过以缩进的空格来作为标杆转换为树形结构，恰巧由于上下文是紧密联系的关系，这个转换的过程正好相当于将原本树形结构以深度优先递归遍历出来的扁平数据结构还原为树。</p>\n<p>所以关键在于记录这个缩进关系（通过对相邻两项缩进的空格数量进行对比来判断彼此关系）。</p>\n<h2 id=\"还原算法的关键点\" style=\"position:relative;\"><a href=\"#%E8%BF%98%E5%8E%9F%E7%AE%97%E6%B3%95%E7%9A%84%E5%85%B3%E9%94%AE%E7%82%B9\" aria-label=\"还原算法的关键点 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>还原算法的关键点</h2>\n<ul>\n<li>不断对比相邻两项的空格数来确定相邻两项的级联关系</li>\n<li>如何保证对比的临界值（平铺的同级根节点会有多个，相邻根节点就是对应的索引就是临界）</li>\n<li>为了方便查找元数据的每一项实现给每一条数据添加unique id</li>\n</ul>\n<h2 id=\"倒序复原深度优先遍历数据结构\" style=\"position:relative;\"><a href=\"#%E5%80%92%E5%BA%8F%E5%A4%8D%E5%8E%9F%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E9%81%8D%E5%8E%86%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84\" aria-label=\"倒序复原深度优先遍历数据结构 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>倒序复原深度优先遍历数据结构</h2>\n<p>需要注意的是还原深度优先的数据结构使用前先翻转使用方便正确查找插入；\n同时通过这个还原之后得到的结构时逆序的所以需要翻转整个List：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 1.</span>\n<span class=\"token function\">formatController</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// 2.</span>\n<span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>具体实现过程：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">formatController</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">_reverseArray</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">reverseArray</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 遍历的过程不断的从原List截取数据放到Tree中</span>\n    <span class=\"token comment\">// 保持原List备份</span>\n    <span class=\"token keyword\">const</span> loopArray <span class=\"token operator\">=</span> reverseArray<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 每次对比只需要考虑还没有比较过的根节点</span>\n    <span class=\"token comment\">// pointer记录当前从哪里开始比较</span>\n    <span class=\"token keyword\">let</span> pointer <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\n    <span class=\"token comment\">// 借助while只要pointer在原List索引范围内则继续查找</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>pointer <span class=\"token operator\">&lt;</span> loopArray<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 获取当前索引所在数据</span>\n      <span class=\"token keyword\">const</span> pointerData <span class=\"token operator\">=</span> loopArray<span class=\"token punctuation\">[</span>pointer<span class=\"token punctuation\">]</span>\n      <span class=\"token comment\">// 标识符 判断是否当前查询的元素存在子元素（缩进数大于当前项）</span>\n      <span class=\"token keyword\">let</span> findSubordinates\n      <span class=\"token comment\">// 正在遍历的对象</span>\n      <span class=\"token keyword\">let</span> current\n      <span class=\"token comment\">// 从外部记录的索引开始</span>\n      <span class=\"token keyword\">let</span> k <span class=\"token operator\">=</span> pointer\n\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">&lt;</span> loopArray<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        current <span class=\"token operator\">=</span> loopArray<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span>\n\n        <span class=\"token comment\">// 由于还原深度 接受的List经过倒序处理过</span>\n        <span class=\"token comment\">// 判断current.tabSize &lt; pointerData.tabSize 而非 current.tabSize > pointerData.tabSize</span>\n        <span class=\"token comment\">// 判断是其子元素则将当前索引指向的数据推入当前项子元素List中</span>\n        <span class=\"token comment\">// 同时从原List移除</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>current<span class=\"token punctuation\">.</span>tabSize <span class=\"token operator\">&lt;</span> pointerData<span class=\"token punctuation\">.</span>tabSize<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// 当前索引</span>\n          reverseArray<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span>\n            reverseArray<span class=\"token punctuation\">.</span><span class=\"token function\">findIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> id <span class=\"token operator\">===</span> pointerData<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">)</span>\n\n          current<span class=\"token punctuation\">.</span>children <span class=\"token operator\">=</span> current<span class=\"token punctuation\">.</span>children <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n          current<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">.</span><span class=\"token function\">unshift</span><span class=\"token punctuation\">(</span>pointerData<span class=\"token punctuation\">)</span>\n\n          <span class=\"token comment\">// 代表当次循环找到子元素</span>\n          <span class=\"token comment\">// 中断此次查找</span>\n          <span class=\"token comment\">// 索引位置不变 开启下次查找</span>\n          findSubordinates <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n\n          <span class=\"token keyword\">break</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>findSubordinates<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">loop</span><span class=\"token punctuation\">(</span>reverseArray<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">break</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// 未查找到子元素 索引自增开启下一轮查找</span>\n      pointer<span class=\"token operator\">++</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> reverseArray\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token function\">loop</span><span class=\"token punctuation\">(</span>_reverseArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>剪贴板文本：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1\n\n2\n  2-1\n    2-1-1\n    2-1-2\n  2-2\n\n3\n\n4\n  5</code></pre></div>\n<p>格式化：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">format</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">string</span> <span class=\"token operator\">=></span> string<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/\\n+/</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  text<span class=\"token punctuation\">,</span>\n  tabSize<span class=\"token operator\">:</span> <span class=\"token regex\">/^( )+/</span><span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">?.</span>length<span class=\"token punctuation\">,</span>\n  children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// id: uuid.generate(),</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> flatTree <span class=\"token operator\">=</span> <span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// output:</span>\n<span class=\"token comment\">// [</span>\n<span class=\"token comment\">// \t{ text: ' 5', tabSize: 2, id: 'ifDrcusVgaNJGRWem3fFVS', children: [] },</span>\n<span class=\"token comment\">// \t{ text: '4', tabSize: 0, id: 'p8BEPrFAdFtfiKm6mfeTcc', children: [] },</span>\n<span class=\"token comment\">// \t{ text: '3', tabSize: 0, id: '9GqDaxK67ToLNQcPQjmKvK', children: [] },</span>\n<span class=\"token comment\">// \t{ text: '    2-1-2', tabSize: 4, id: 'jG8prFHP9tXgbJSoqCYbki', children: [] },</span>\n<span class=\"token comment\">// \t{ text: '    2-1-1', tabSize: 4, id: 'rvevchHuysMgAuDkzcr6ej', children: [] },</span>\n<span class=\"token comment\">// \t{ text: '  2-1', tabSize: 2, id: 'wF4sAFnVT7enhx8efEvGNB', children: [] },</span>\n<span class=\"token comment\">// \t{ text: '2', tabSize: 0, id: 'w2cXb6ojkvEMm7tz3r1Qui', children: [] },</span>\n<span class=\"token comment\">// \t{ text: '1', tabSize: 0, id: 'nJCwvvptZuDAtiSCz9DjtL', children: [] }</span>\n<span class=\"token comment\">// ]</span></code></pre></div>\n<p>最终调用 <code class=\"language-text\">formatController(flatTree)</code> 得到树形结构:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">[</span>\n\t<span class=\"token punctuation\">{</span>\n\t\ttext<span class=\"token operator\">:</span> <span class=\"token string\">'4'</span><span class=\"token punctuation\">,</span>\n\t\ttabSize<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n\t\tid<span class=\"token operator\">:</span> <span class=\"token string\">'p8BEPrFAdFtfiKm6mfeTcc'</span><span class=\"token punctuation\">,</span>\n\t\tchildren<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">{</span> text<span class=\"token operator\">:</span> <span class=\"token string\">'  5'</span><span class=\"token punctuation\">,</span> tabSize<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'ifDrcusVgaNJGRWem3fFVS'</span><span class=\"token punctuation\">,</span> children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">]</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">{</span> text<span class=\"token operator\">:</span> <span class=\"token string\">'3'</span><span class=\"token punctuation\">,</span> tabSize<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'9GqDaxK67ToLNQcPQjmKvK'</span><span class=\"token punctuation\">,</span> children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">{</span>\n\t\ttext<span class=\"token operator\">:</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span>\n\t\ttabSize<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n\t\tid<span class=\"token operator\">:</span> <span class=\"token string\">'w2cXb6ojkvEMm7tz3r1Qui'</span><span class=\"token punctuation\">,</span>\n\t\tchildren<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n\t\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\ttext<span class=\"token operator\">:</span> <span class=\"token string\">'  2-1'</span><span class=\"token punctuation\">,</span>\n\t\t\t\ttabSize<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n\t\t\t\tid<span class=\"token operator\">:</span> <span class=\"token string\">'wF4sAFnVT7enhx8efEvGNB'</span><span class=\"token punctuation\">,</span>\n\t\t\t\tchildren<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n\t\t\t\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\t\t\ttext<span class=\"token operator\">:</span> <span class=\"token string\">'    2-1-1'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\ttabSize<span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\tid<span class=\"token operator\">:</span> <span class=\"token string\">'rvevchHuysMgAuDkzcr6ej'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\tchildren<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\t\t\t\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\t\t\ttext<span class=\"token operator\">:</span> <span class=\"token string\">'    2-1-2'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\ttabSize<span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\tid<span class=\"token operator\">:</span> <span class=\"token string\">'jG8prFHP9tXgbJSoqCYbki'</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\tchildren<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\t\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t\t<span class=\"token punctuation\">]</span>\n\t\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t\t\t<span class=\"token punctuation\">{</span> text<span class=\"token operator\">:</span> <span class=\"token string\">'  2-2'</span><span class=\"token punctuation\">,</span> tabSize<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'j6eUAMJdD2PqhfZLVEs5nS'</span><span class=\"token punctuation\">,</span> children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">]</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token punctuation\">{</span> text<span class=\"token operator\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> tabSize<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> id<span class=\"token operator\">:</span> <span class=\"token string\">'nJCwvvptZuDAtiSCz9DjtL'</span><span class=\"token punctuation\">,</span> children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>树形结构就很容易在业务中使用了（递归渲染级联关系）。\n写后端导出数据为Markdown文件时正好是将数据库级联字段深度优先遍历出来进行字符串的拼接以及写入文件；而将外部文件导入或者通过剪贴板粘贴时候又是将扁平字符串转为树形结构。</p>\n<p>一饮一啄皆是天定。</p>\n<h2 id=\"the-end\" style=\"position:relative;\"><a href=\"#the-end\" aria-label=\"the end permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>THE END</h2>","timeToRead":3,"excerpt":"…","frontmatter":{"title":"块编辑器：解析文本缩进父子关系还原深度优先遍历算法","thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAADHUlEQVQ4y5VUbUhTURg+26JfQb8F9Z5t9+7jujk/tmuZaGppGWZ+pGSoGKalpaLO/P6MpWJUgoFR9LNCsgwUpSxLMW2bUwkxzZWa5QdpJlpkcTvnuPzXpgcuz3uel/vwPO859wJgZ31McgefMlhSf6tlRBh/3Ja6rTVKl1au0gl4v3pdKlw2MGBbazJWQ/BrhVyIcaVO6rTeRE/z92T86g26G3N/HkgESNyx2Ii3FjwGQWAuV7nFzeXJe5HTXz8bGH7ZQLdj7ns9LUC1Y0GzmNt0GedOok6dURtm0lT850zl7EYJy8/lMhmYn9czImu03L6YCfoQHAvxJFHHIz11E1Eev63xmomFVA0/c041vVik2IN7sxdZgV2xHugP+ig/MCTWgrlmNeGG3bUDo8Fei+MRngtTcZ689ZQmFvMfTm+6Xyiwcygv4CGbS05ki540AvfxFlY3PObF8SMe2vlBRueEexaFTjCvl9mP2wGPAROlI/UbSisyQp9JJD5jorgvE9CXN1PcXdwzUpzA7MwBNFfHB9ILA4i7Xiog0Sz25weo/SYLcmmE3JJJwrmRBBQndCjUIM0ET+ER0EMdJIPugiF9aAQLaG99Kwnk+6FvJ+b7oJ+w3/UAsMh0/xerleWBGpketMHjROwJPCFvg+EbHTBs8BkMXTdJjvKvYCC5Ki9hsMg2Z8dxm8VxuzC2wJh09Ky3iiOH++hYHs12qIsKJUKdMAwYHYlhd3XIZatrFJnNLcnZO/dhvPUhPLn0CEZbW8Qx7KbzSNJ/Tfk6dlfL5Als6FLD6C03JemDTZLU99forCzMj7q4C5w178BzeBjFDrIvls9WgTJlCREsVZYylYqi7kpF8Vq1vHD1iizfA/OV8mIhj7Adhjt2hwWRCKmL2HKPYra8FAmnVCsKyWdQpSgkvUZpxvZ+VXImGeSo64jDbFWNU7bKIP7Xuyy/tPW91jM5YNsrwa2KvJimrvM+r67di+sSZRk5hAuaGiRcAAxM/jYdypIJqmQpu30VmeTGRij1hCtgKwAaAdjRwpFt6CSlE8ncaCZJgOLvSOcvuDsP7YSsLpgAAAAASUVORK5CYII=","width":150,"height":150,"src":"/static/15b1871ea4c811121febad33ed4becb6/4148e/post.png","srcSet":"/static/15b1871ea4c811121febad33ed4becb6/4148e/post.png 1x"}}},"slug":"block-editor-depth-first","date":"2020-09-29T00:00:00.000Z","categories":["Algorithm"],"tags":["block editor"],"template":"post"},"fields":{"slug":"/block-editor-depth-first/","date":"2020-09-29T00:00:00.000Z"}}},"pageContext":{"slug":"/block-editor-depth-first/"}}}